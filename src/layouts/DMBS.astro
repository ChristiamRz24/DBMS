---
const { pageName } = Astro.props;
import ChangeDB from "./ChangeDB.astro";

import "../pages/_index.css";

const fetchData = async () => {
  try {
    const response = await fetch(
      `http://localhost:4321/api/${pageName}/tables/names.json`,
    );
    return await response.json();
  } catch (error) {
    console.error("Error fetching data:", error);
    return []; // Retorna un arreglo vac√≠o en caso de error
  }
};

const tableNames = await fetchData();
---

<div class="container p-10">
  <div class="row">
    <div class="col-12">
      <div>
        <a href="/" class="text-blue-500 hover:underline">Inicio</a>
        <span class="mx-2">|</span>
        <ChangeDB />
        <h2 class="text-lg my-5 text-slate-400">
          Tablas de la base de datos: <strong>{pageName}</strong>
        </h2>
        <ul class="flex flex-wrap gap-1">
          {
            tableNames &&
              tableNames.map((tableName: any) => (
                <li class="py-5 px-6 bg-slate-800 rounded hover:cursor-pointer hover:bg-slate-700">
                  {tableName.table_name}
                </li>
              ))
          }
        </ul>
      </div>
    </div>
  </div>
</div>
